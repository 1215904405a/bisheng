<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Watch.js Test</title>
  <link  href="../demo/bootstrap/css/bootstrap.css" rel="stylesheet">
  <script src="../demo/jquery.js"></script>
  <script src="../demo/underscore.js"></script>
  <script src="../demo/mock.js"></script>
  <script src="../demo/handlebars.js"></script>
  <script src="../src/watch.js"></script>
</head>
<body>
<div class="container">
  <h1>Watch.js</h1>
  <script type="text/javascript">
    function doit(data){
      Watch.watch(data, ['get', 'set', 'add', 'delete', 'change'], function(event, data){
        Watch.log(event, data)
      })
    }
    function run(code){
      console.group(code);
      eval(code)
      console.groupEnd(code);
    }
  </script>

  <h2>Simple Object</h2>
  <div class="simple-object">
    <pre></pre>
    <button type="button" class="btn btn-default">Run</button>
  </div>
  <script type="text/javascript">
    var data1 = { prop1: 'foo' }
    console.group('Simple Object', JSON.stringify(data1))
    doit(data1)
    run("data1.prop1 = 'foo'")
    run("data1.prop1 = 'bar'")
    run("data1.prop1 = 'bar'")
    console.groupEnd('Simple Object')
  </script>

  <h2>Nested Object</h2>
  <script type="text/javascript">
    var data2 = {
      prop2: {
        prop3: 'foo'
      }
    }
    console.group('Nested Object', JSON.stringify(data2))
    doit(data2)

    run("data2.prop2")
    run("data2.prop2.prop3")
    run("data2.prop2.prop3 = 'foo'")
    run("data2.prop2.prop3 = 'bar'")
    run("data2.prop2.prop3 = 'bar'")

    run("data2.prop2 = { prop4: 'foo'}")
    run("data2.prop2.prop4")
    run("data2.prop2.prop4 = 'foo'")
    run("data2.prop2.prop4 = 'bar'")
    run("data2.prop2.prop4 = 'bar'")

    console.groupEnd('Nested Object')
  </script>

  <h2>Simple Array</h2>
  <script type="text/javascript">
    var data3 = [0, 1, 2]
    console.group('Simple Array', JSON.stringify(data3))
    doit(data3)

    run("data3[0]")
    run("data3[0] = '00'")
    run("data3[0] = '00'")
    run("data3[0] = data3[1]")

    run("data3.push(3)")

    console.groupEnd('Simple Array')
  </script>

  <h2>Nested Array</h2>
  <script type="text/javascript">
    var data4 = [
      [0, 1, 2],
      [11, 12, 13],
      [21, 22, 23]
    ]
    console.group('Nested Array', JSON.stringify(data4))
    doit(data4)

    run("data4[0]")
    run("data4[0] = '00'")
    run("data4[0] = '00'")
    run("data4[0] = data4[1]")

    run("data4.push(3)")
    
    console.groupEnd('Simple Array')
  </script>

</div>
  <script>
    /*var data = Mock.mock({
      title: '@TITLE',
      a: {
        b: {
          c: {
            d: {
              e: {
                f: {
                  g: '@EMAIL'
                }
              }
            }
          }
        }
      },
      'list|2-10': [{
        'id|+1': 1,
        'name': '@NAME',
        'guid': '@GUID'
      }]
    })

    $(data).on('add delete change', function(event, data){
      console.log(event.type, data.path.join('.'), data);
    })*/

    // Watch.define(data, true)

    /*
    setInterval(function(){
      var index = Random.integer(0, data.list.length - 1)
      if(data.list[index]) data.list[index].guid = Random.guid()
    }, 1000 * 2)
    */
  
    /*setInterval(function(){
      if (Math.random() > 0.5) {
        data.list.push({
          id: Random.integer(),
          name: Random.name(),
          guid: Random.guid()
        })
        data.list[data.list.length - 1].guid = Random.guid()
      } else {
          data.list.pop()
      }
    }, 1000 * 2)*/
  </script>
</body>
</html>
